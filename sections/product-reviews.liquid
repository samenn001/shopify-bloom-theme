{{ 'section-product-reviews.css' | asset_url | stylesheet_tag }}

<div class="product-reviews-section">
  <div class="page-width">
    <div class="reviews-header">
      <h2 class="reviews-title">{{ section.settings.title }}</h2>
      <div class="reviews-summary">
        <div class="stars-rating">
          {% for i in (1..5) %}
            <svg class="star-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          {% endfor %}
        </div>
        <span class="review-count">{{ section.settings.review_count }} Reviews</span>
      </div>
    </div>

    <div class="reviews-grid">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'review' %}
            <div class="review-card" {{ block.shopify_attributes }}>
              {% if block.settings.has_video %}
                <div class="review-video-wrapper">
                  <video 
                    class="review-video"
                    controls
                    playsinline
                    muted
                    loop
                    poster="{{ block.settings.video_poster | img_url: 'master' }}"
                  >
                    <source src="{{ block.settings.video_url }}" type="video/mp4">
                  </video>
                  <div class="video-play-overlay">
                    <svg class="play-icon" width="48" height="48" viewBox="0 0 24 24" fill="white">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </div>
                </div>
              {% endif %}
              
              <div class="review-content">
                <div class="review-header">
                  <div class="reviewer-info">
                    <div class="reviewer-avatar">
                      {{ block.settings.reviewer_name | slice: 0 | upcase }}
                    </div>
                    <div class="reviewer-details">
                      <h4 class="reviewer-name">{{ block.settings.reviewer_name }}</h4>
                      <div class="review-meta">
                        <div class="review-stars">
                          {% for i in (1..5) %}
                            <svg class="star-icon {% if i <= block.settings.rating %}filled{% endif %}" width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                          {% endfor %}
                        </div>
                        <span class="review-date">{{ block.settings.review_date }}</span>
                      </div>
                    </div>
                  </div>
                  {% if block.settings.verified_purchase %}
                    <div class="verified-badge">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                      </svg>
                      Verified
                    </div>
                  {% endif %}
                </div>
                
                {% if block.settings.product_variant %}
                  <div class="review-variant">Purchased: {{ block.settings.product_variant }}</div>
                {% endif %}
                
                <p class="review-text">{{ block.settings.review_text }}</p>
                
                {% if block.settings.show_helpful %}
                  <div class="review-actions">
                    <button class="helpful-btn">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/>
                      </svg>
                      Helpful
                    </button>
                  </div>
                {% endif %}
              </div>
            </div>
        {% endcase %}
      {% endfor %}
    </div>

    {% if section.settings.show_load_more %}
      <div class="reviews-footer">
        <button class="load-more-btn">View More Reviews</button>
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Product Reviews",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "What Our Customers Say"
    },
    {
      "type": "text",
      "id": "review_count",
      "label": "Total Review Count",
      "default": "126"
    },
    {
      "type": "checkbox",
      "id": "show_load_more",
      "label": "Show Load More Button",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "review",
      "name": "Customer Review",
      "settings": [
        {
          "type": "text",
          "id": "reviewer_name",
          "label": "Reviewer Name",
          "default": "Customer Name"
        },
        {
          "type": "range",
          "id": "rating",
          "label": "Rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        },
        {
          "type": "text",
          "id": "review_date",
          "label": "Review Date",
          "default": "2 days ago"
        },
        {
          "type": "text",
          "id": "product_variant",
          "label": "Product Variant",
          "default": "Blue Black"
        },
        {
          "type": "textarea",
          "id": "review_text",
          "label": "Review Text",
          "default": "Amazing product! My cats absolutely love it."
        },
        {
          "type": "checkbox",
          "id": "verified_purchase",
          "label": "Verified Purchase",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "has_video",
          "label": "Has Video",
          "default": false
        },
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL"
        },
        {
          "type": "image_picker",
          "id": "video_poster",
          "label": "Video Poster Image"
        },
        {
          "type": "checkbox",
          "id": "show_helpful",
          "label": "Show Helpful Button",
          "default": true
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Reviews",
      "blocks": [
        {
          "type": "review",
          "settings": {
            "reviewer_name": "la***2d",
            "rating": 5,
            "review_date": "Jul 9, 2025",
            "product_variant": "Blue Black",
            "review_text": "O M G My mainecoon and I love it!! I do wish it were up off the ground just a bit more. And maybe the motor part just a bit more power. Or, maybe this company just needs to make a bigger version for bigger breeds?? Easy, Fun, lots of laughs, lots of craziness. Happy Fur Mama",
            "verified_purchase": true,
            "has_video": true,
            "video_url": "https://cdn.shopify.com/videos/c/o/v/126d206cd73948039c829665934afc23.mp4"
          }
        },
        {
          "type": "review",
          "settings": {
            "reviewer_name": "al***rd",
            "rating": 5,
            "review_date": "May 20, 2025",
            "product_variant": "Blue Black",
            "review_text": "My kitten LOVES it so much i have to mount the pieces down so he stops knocking them over he having some much fun. oh and I really like how you can make them as long or short as you like plus just about shape",
            "verified_purchase": true,
            "has_video": true,
            "video_url": "https://cdn.shopify.com/videos/c/o/v/126d206cd73948039c829665934afc23.mp4"
          }
        },
        {
          "type": "review",
          "settings": {
            "reviewer_name": "se***on",
            "rating": 5,
            "review_date": "Jan 4, 2025",
            "product_variant": "Blue Black",
            "review_text": "I have 2 three year old Ragdoll cats. This is a wonderful item. It really works them out. My only issue is I don't know who is enjoying it more, the cats or my husband",
            "verified_purchase": true,
            "has_video": true,
            "video_url": "https://cdn.shopify.com/videos/c/o/v/132fae2c9af04bccb01bfc84b0d9c1c3.mp4"
          }
        },
        {
          "type": "review",
          "settings": {
            "reviewer_name": "Jeremy Fobes",
            "rating": 5,
            "review_date": "Jan 7, 2025",
            "product_variant": "Blue Black",
            "review_text": "My cats absolutely love this toy so far. only problem is only having one isn't enough for all 4 of our cats but only because our black cat is a lot more energetic and hyper than the others",
            "verified_purchase": true,
            "has_video": true,
            "video_url": "https://cdn.shopify.com/videos/c/o/v/01a426f18677426f8431957544eecabb.mp4"
          }
        },
        {
          "type": "review",
          "settings": {
            "reviewer_name": "br***64",
            "rating": 5,
            "review_date": "Jan 11, 2025",
            "product_variant": "Blue Black",
            "review_text": "My cats love this. It's kept them entertained for at least 30 minutes now which is more than I can say for any other of their toys.",
            "verified_purchase": true,
            "has_video": false
          }
        },
        {
          "type": "review",
          "settings": {
            "reviewer_name": "Audrey Oh",
            "rating": 5,
            "review_date": "Jan 28, 2025",
            "product_variant": "Blue Black",
            "review_text": "My cats love it. The instructions aren't the most helpful, but it's pretty intuitive. I have no desire to buy the more expensive version.",
            "verified_purchase": true,
            "has_video": false
          }
        }
      ]
    }
  ]
}
{% endschema %}